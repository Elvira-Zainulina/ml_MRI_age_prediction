# -*- coding: utf-8 -*-
"""functions.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1SMfsJjTUrI2lQ-JktEw9zjnboeYuVK5r
"""

import numpy as np
import pandas as pd

def data_formation (full_train_names, train_names, val_names, test_names, data, target):
  X_full_train = []
  y_full_train = []
  for name in full_train_names:
    X_full_train.append(data.values[data.Subject.values==name][0])
    y_full_train.append(target.values[target.Subject.values==name][0])

  X_train = []
  y_train = []
  for name in train_names:
    X_train.append(data.values[data.Subject.values==name][0])
    y_train.append(target.values[target.Subject.values==name][0])

  X_test = []
  y_test = []
  for name in test_names:
    X_test.append(data.values[data.Subject.values==name][0])
    y_test.append(target.values[target.Subject.values==name][0])

  X_val = []
  y_val = []
  for name in test_names:
    X_val.append(data.values[data.Subject.values==name][0])
    y_val.append(target.values[target.Subject.values==name][0])

  y_full_train = np.array(y_full_train)
  y_full_train = list(y_full_train[:,4])
  y_train = np.array(y_train)
  y_train = list(y_train[:,4])
  y_test = np.array(y_test)
  y_test = list(y_test[:,4])
  y_val = np.array(y_val)
  y_val = list(y_val[:,4])

  return X_full_train, y_full_train, X_train, y_train, X_val, y_val, X_test, y_test

def three_classes(X_full_train, y_full_train, X_train, y_train, X_val, y_val):
  val_36 = np.where(y_val == 3)
  train_36 = np.where(y_train == 3)
  full_train_36 = np.where(y_full_train == 3)

  X_full_train = np.delete(X_full_train, full_train_36, 0)
  X_train = np.delete(X_train, train_36, 0)
  X_val = np.delete(X_val, val_36, 0)

  y_full_train = np.delete(y_full_train, full_train_36, 0)
  y_train = np.delete(y_train, train_36, 0)
  y_val = np.delete(y_val, val_36, 0)

  full_train_X, full_train_y = X_full_train, list(y_full_train)
  train_X, train_y  = X_train, list(y_train)
  val_X, val_y  = X_val, list(y_val)

  return X_full_train, y_full_train, X_train, y_train, X_val, y_val